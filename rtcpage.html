<!doctype html>
<html>
    <script>

const wsControllerPort = WSCONTROLLERPORT; // this is filled in in the C++ code
const wsControllerHandshakeID = HANDSHAKEID; // also filled in by the C++ code

async function main()
{
    let stream = await navigator.mediaDevices.getUserMedia({video:true, audio:false});
    let localVideo = document.getElementById("localvideo");
    localVideo.srcObject = stream;
    localVideo.play();

    console.warn("Port is (2) " + wsControllerPort);
    console.warn("Handshake ID is " + wsControllerHandshakeID);

    let ws = new WebSocket("ws://localhost:" + wsControllerPort);
    ws.onopen = () => { 
        console.warn("WebSocket opened");
        ws.send(wsControllerHandshakeID);
    }
    ws.onclose = () => console.warn("WebSocket closed");
    ws.onerror = () => console.warn("WebSocket error");
    ws.onmessage = (msg) => console.warn("Received message: " + msg);
}

main();
    </script>
    <body>
        <video id="localvideo"></video>
    </body>
</html>
